##################################################
#
# Protocol File
#
# Protocol file for Lauda Ecoline Staredition RE2xx
# Diamond Light Source, Oct 2008
#
# NOTES:
#
#
#
##################################################


##################################################
# General Settings
##################################################

Terminator = "\r\n";
ReplyTimeout = 1000;


###################################################
# Get functions
###################################################

# /// Read water bath temperature
getTemp {
   ExtraInput = Ignore;
   out "IN_PV_00";
   in "%f";
}

# /// Read external pt100 temperature
getExtTemp {
   ExtraInput = Ignore;
   out "IN_PV_03";
   in "%f";
}

# /// Read over temperature status
getStatus {
   ExtraInput = Ignore;
   seperator = "";
   out "STAT";
   in "%5d";
}

# /// Read program status
getProgRunning {
   ExtraInput = Ignore;
   out "RMP_IN_05";
   in "%1d";
}

# /// Read water bath level
getLevel {
   ExtraInput = Ignore;
   out "IN_PV_05";
   in "%d";
}

# /// Read pump level (1 to 8)
getPump {
   ExtraInput = Ignore;
   out "IN_SP_01";
   in "%d";
}

###################################################
# Set functions
###################################################

# /// Set the setpoint for water temperature (temperature must be specific format (up to 3 digits before decimal point and up to 2 digits after decimal point).
setTemp {
   out "OUT_SP_00_%.2f";
}

# /// Set the pump level (0 to 8)
setPump {
   out "OUT_SP_01_%d";
}

# /// Set the cooling mode (0=OFF/1=ON/2=AUTOMATIC)
setCoolingMode {
   out "OUT_SP_02_%d";
}

# /// Start a program running
startProg {
   out "RMP_RESET";
   out "RMP_OUT_00_%(\$1:TEMP.VAL).2f_0.01";
   out "RMP_OUT_00_%(\$1:RTEMP.VAL).2f_%(\$1:RTIME.VAL)d";   
   out "RMP_OUT_02_1";
   out "RMP_START";
}

# /// Stop a program running
stopProg {
   out "RMP_STOP";
}

#############################################################
# Generic protocol
############################################################

# /// Use this send any command and get back the response (max 39 chars).
gen {
    ExtraInput = Ignore;
    out "%s";
    in "%39c"
}
